include(FetchContent)
include(functions/NovelRTDeps_Populate)
message(STATUS "Fetching OpenAL-Soft...")

set(ALSOFT_UTILS OFF)
set(ALSOFT_NO_CONFIG_UTIL ON)
set(ALSOFT_EXAMPLES OFF)
set(ALSOFT_INSTALL_EXAMPLES OFF)
set(ALSOFT_INSTALL_UTILS OFF)
set(ALSOFT_TESTS OFF)

if(NOVELRT_SHARED_OPENAL OR NOVELRT_BUILD_SHARED_LIBS)
  set(type SHARED)
else()
  set(type STATIC)
endif()

FetchContent_Declare(OpenAL
  URL https://github.com/kcat/openal-soft/archive/refs/tags/1.21.1.zip
  URL_HASH SHA512=bc17d628548e59d0db3996917d207a4af0bbbf615ba3ba10ae8e99b28213e845e967a0510c8aad74e551aa66ddfb11499fe26082725af82160ac5d2db4e7e69d

  PREFIX "${CMAKE_CURRENT_BINARY_DIR}"
  TMP_DIR "${CMAKE_CURRENT_BINARY_DIR}/tmp"
  STAMP_DIR "${CMAKE_CURRENT_BINARY_DIR}/stamp"
  DOWNLOAD_DIR "${CMAKE_CURRENT_BINARY_DIR}/dl"
  SOURCE_DIR "${CMAKE_CURRENT_BINARY_DIR}/src"
  SUBBUILD_DIR "${CMAKE_CURRENT_BINARY_DIR}/build"
  BINARY_DIR "${CMAKE_CURRENT_BINARY_DIR}/bin"
  INSTALL_DIR "${CMAKE_CURRENT_BINARY_DIR}/inst"
  LOG_DIR "${CMAKE_CURRENT_BINARY_DIR}/log"
)

set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS OFF)

NovelRTDeps_PopulateExplicit(OpenAL ${type})

set_target_properties(OpenAL PROPERTIES WINDOWS_EXPORT_ALL_SYMBOLS OFF)
add_library(OpenAL::OpenAL ALIAS OpenAL)
