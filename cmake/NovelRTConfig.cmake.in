include(CMakeFindDependencyMacro)

option(NOVELRT_USE_EXTERNAL "Forcefully look for system libraries instead of assuming NovelRT's versions are located here" OFF)
set(NOVELRT_INTERNAL_LIB_DIR "${CMAKE_CURRENT_LIST_DIR}/../..")

list(PREPEND CMAKE_MODULE_PATH "${CMAKE_CURRENT_LIST_DIR}")
find_dependency(Vulkan REQUIRED)

if(NOVELRT_USE_EXTERNAL)
  find_dependency(spdlog REQUIRED)
  find_dependency(TBB REQUIRED)
  find_dependency(Microsoft.GSL REQUIRED)
  find_dependency(stduuid REQUIRED)
  find_dependency(glfw3 CONFIG REQUIRED)
  find_dependency(glm REQUIRED)
  find_dependency(jsoncons REQUIRED)
  find_dependency(Ogg REQUIRED)
  find_dependency(OpenAL CONFIG REQUIRED)
  find_dependency(Opus REQUIRED)
  find_dependency(Vorbis REQUIRED)
  find_dependency(flac REQUIRED)
  find_dependency(SndFile REQUIRED)
  find_dependency(ZLIB REQUIRED)
  find_dependency(PNG REQUIRED)
  find_package(nlohmann_json REQUIRED)
  include("${NOVELRT_INTERNAL_LIB_DIR}/fabulist.cmake")
else()
  set(NOVELRT_INTERNAL_LIB_CMAKE_DIR "${NOVELRT_INTERNAL_LIB_DIR}/cmake")
  set(NOVELRT_INTERNAL_SHARE_DIR "${NOVELRT_INTERNAL_LIB_DIR}/../share")
  # Follow the same order that the Internal deps' CMakeLists follows for sanity's sake
  #include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/nlohmann_json/nlohmann_jsonConfig.cmake")
  set(nlohmann_json_DIR "${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/nlohmann_json")
  find_dependency(nlohmann_json REQUIRED)
  include("${NOVELRT_INTERNAL_LIB_DIR}/fabulist.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/glfw3/glfw3Config.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/glm/glmConfig.cmake")
  include("${NOVELRT_INTERNAL_SHARE_DIR}/cmake/Microsoft.GSL/Microsoft.GSLConfig.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/jsoncons/jsonconsConfig.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/ZLIB/ZLIBConfig.cmake")
  include("${NOVELRT_INTERNAL_LIB_DIR}/libpng/libpng16.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/Ogg/OggConfig.cmake")
  set(Ogg_DIR "${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/Ogg")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/Opus/OpusConfig.cmake")
  set(Opus_DIR "${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/Opus")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/Vorbis/VorbisConfig.cmake")
  set(Vorbis_DIR "${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/Vorbis")
  include("${NOVELRT_INTERNAL_SHARE_DIR}/FLAC/cmake/flac-config.cmake")
  set(FLAC_DIR "${NOVELRT_INTERNAL_SHARE_DIR}/FLAC/cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/SndFile/SndFileConfig.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/TBB/TBBConfig.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/OpenAL/OpenALConfig.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/spdlog/spdlogConfig.cmake")
  include("${NOVELRT_INTERNAL_LIB_CMAKE_DIR}/stduuid/stduuid-config.cmake")
endif()

include("${CMAKE_CURRENT_LIST_DIR}/NovelRTTargets.cmake")

add_dependencies(NovelRT::Engine NovelRT::ResourceFiles)
